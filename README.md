# ci_smarty
[Smarty 3](http://www.smarty.net/) support for CodeIgniter 3

## Features
1. Easy access to Smarty engine with standard CI's pattern `$this->smarty->...`
2. Object `$this->smarty` extends native Smarty's class `Smarty`, so you can just use Smarty: no new syntax, no new wrappers, no new knowledge ;)
3. Method `$this->smarty->display()` uses CI's Output Class, so CI views are still accessible and the library `ci_smarty` does not break any output generated by CodeIgniter.
4. Moreover, in one application both CI views and Smarty templates can be used; that's why it's recommended to have a separate directory for templates (i.e. `application/templates`).

## Installation
1. Install Smarty:
   * using [Composer](https://getcomposer.org/):
     * [CodeIgniter: Auto-loading Resources](https://www.codeigniter.com/user_guide/general/autoloader.html)
     * [Installing Smarty with Composer](https://github.com/smarty-php/smarty/blob/master/README.md)
   * or any other way; make sure, that class `Smarty` is available in scope in `JC_Smarty.php`
2. Copy `JC_Smarty.php` to `application/libraries`
3. Copy `smarty.php` to `application/config`:
   * set all reqired paths (however, default paths will be OK for many cases),
   * make sure these paths exist,
   * make sure the paths where cache and compiled templates are stored -- are writable for HTTP server process,
   * tell your VCS to ignore the content of the cache directory and the compiled templates directory,
   * it's convenient to have another `smarty.php` in `application/config/development` (for example, one can turn off caching in development version)
4. Add autoloading of `JC_Smarty.php` in `application/config/autoload.php`:

   ```php
   $autoload['libraries'] = array(
     ...,
     'JC_Smarty' => 'smarty' // add this line
   );
   ```

## Use example
Object `$this->smarty` extends class `Smarty`, so just use any public methods and public properties descibed in [Smarty documentation](http://www.smarty.net/docs/en/smarty.for.programmers.tpl).
```php
// application/controllers/Test.php
class Test extends CI_Controller
{
  public function index()
  {
    $this->smarty->assign('title', 'Test Smarty');
    $this->smarty->assign(array(
      'message' => 'It works!',
      'php_version' => phpversion()
    ));
    $this->smarty->display('test.tpl');
  }
}
```
> Notice, that `test.tpl` is loaded from `$config['TemplateDir']`

```smarty
<!-- application/templates/test.tpl -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>{$title}</title>
  </head>
  <body>
    <h1>{$title}</h1>
    <p>{$message}</p>
    <p class="footer">
      Page rendered in: <strong>{literal}{elapsed_time}{/literal}</strong> seconds.<br>
      Memory usage:  <strong>{literal}{memory_usage}{/literal}</strong>.<br>
      PHP version: <strong>{$php_version}</strong>.<br>
      CodeIgniter version: <strong>{CI_VERSION}</strong>.
    </p>
  </body>
</html>
```

## Customization
1. Create `MY_Smarty.php` in `application/libraries`
2. Extend class `JS_Smarty.php`
3. Change `config/autoload.php`:

   ```php
   $autoload['libraries'] = array(
     ...,
     'MY_Smarty' => 'smarty' // change this line (notice: MY_Smarty, not JS_Smarty)
   );
   ```

#### Example of customization
```php
// application/libraries/MY_Smarty.php
/* make sure JS_Smarty is in scope */
class MY_Smarty extends JS_Smarty
{
   // extend existing methods / add new methods

   public function __construct()
   {
      parent::__construct();
      $this->registerPlugins();
   }

   private function registerPlugins()
   {
      $this->CI->load->model('translations');
      $this->registerPlugin('modifier', 'translate', array($this->CI->translations, 'get'));
   }
}
```
